(this.webpackJsonppuhelinluettelo=this.webpackJsonppuhelinluettelo||[]).push([[0],{16:function(e,t,n){e.exports=n(39)},38:function(e,t,n){},39:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(14),l=n.n(o),c=n(15),u=n(4),i=n(2),m=n(3),s=n.n(m),d="/api/persons",f=function(){return s.a.get(d)},b=function(e){return s.a.post(d,e)},p=function(e,t){return s.a.put("".concat(d,"/").concat(e),t)},E=function(e){return s.a.delete("".concat(d,"/").concat(e))},h=(n(38),function(e){var t=e.text,n=e.type;if(t){var a="Message ".concat(n);return r.a.createElement("div",{className:a},r.a.createElement("p",null,t))}return r.a.createElement(r.a.Fragment,null)}),v=function(e){var t=e.inputFilter,n=e.newFilter;return r.a.createElement(r.a.Fragment,null,r.a.createElement("label",{htmlFor:"filter"},"filter shown with"),r.a.createElement("input",{type:"text",id:"filter",name:"filter",onChange:t,value:n}))},g=function(e){var t=e.inputName,n=e.newName,a=e.inputNumber,o=e.newNumber,l=e.onSubmit;return r.a.createElement(r.a.Fragment,null,r.a.createElement("form",{onSubmit:l},r.a.createElement("table",null,r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("label",{htmlFor:"name"},"name")),r.a.createElement("td",null,r.a.createElement("input",{type:"text",id:"name",name:"name",required:!0,onChange:t,value:n}))),r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("label",{htmlFor:"number"},"number")),r.a.createElement("td",null,r.a.createElement("input",{type:"text",id:"number",name:"number",required:!0,onChange:a,value:o}))),r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("button",{type:"submit"},"add")))))))},w=function(e){var t=e.persons,n=e.onClickDelete,a=t.filter((function(e){return!0===e.display}));return r.a.createElement("table",null,r.a.createElement("tbody",null,a.map((function(e){return r.a.createElement("tr",{key:e.name+"-"+e.id},r.a.createElement("td",null,e.name),r.a.createElement("td",null,e.number),r.a.createElement("td",null,r.a.createElement("button",{onClick:n,"data-id":e.id},"delete")))}))))},y=function(){var e=Object(a.useState)([]),t=Object(i.a)(e,2),n=t[0],o=t[1],l=Object(a.useState)(""),m=Object(i.a)(l,2),s=m[0],d=m[1],y=Object(a.useState)(""),j=Object(i.a)(y,2),O=j[0],C=j[1],N=Object(a.useState)(""),k=Object(i.a)(N,2),F=k[0],S=k[1],x=Object(a.useState)(""),L=Object(i.a)(x,2),D=L[0],I=L[1],q=Object(a.useState)(""),J=Object(i.a)(q,2),A=J[0],B=J[1];Object(a.useEffect)((function(){f().then((function(e){e.data.forEach((function(t,n){return e.data[n].display=!0})),o(e.data)}))}),[]);var M=function(e,t,n){I(e),B(t),setTimeout((function(){I("")}),n)},P=function(e){e.preventDefault(),console.log({persons:n});var t=n.findIndex((function(e){return e.name===s}));if(console.log(t),-1!==t){if(window.confirm("".concat(s," is already added to phonebook, replace the old number with a new one?"))){var a=Object(u.a)(n),r=Object(c.a)({},a[t],{number:O});delete r.display,console.log({updated:r}),p(r.id,r).then((function(e){e.data.display=!0,F&&(e.data.display=e.data.name.toLowerCase().includes(F.toLowerCase())),a[t]=e.data,o(a),M("Number of ".concat(s," changed"),"success",5e3),console.log(e)})).catch((function(e){console.log(e),M("Information of ".concat(s," has already been removed from server"),"error",5e3),f().then((function(e){e.data.forEach((function(t,n){e.data[n].display=!F||e.data[n].name.toLowerCase().includes(F.toLowerCase())})),o(e.data)}))}))}}else{var l={name:s,number:O};console.log(l),b(l).then((function(e){console.log(e),e.data.display=!0,F&&(e.data.display=e.data.name.toLowerCase().includes(F.toLowerCase())),o(n.concat(e.data)),M("".concat(s," added to phonebook"),"success",5e3)})).catch((function(e){console.log(e.response.data.error),M("".concat(e.response.data.error),"error",5e3)}))}d(""),C("")};return r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("h2",null,"Phonebook"),r.a.createElement(h,{text:D,type:A}),r.a.createElement(v,{inputFilter:function(e){var t=e.target.value;S(t);var a=Object(u.a)(n);return t?(console.log("string exists"),a.forEach((function(e){return e.display=e.name.toLowerCase().includes(t.toLowerCase())}))):(console.log("no string"),a.forEach((function(e){return e.display=!0}))),console.log("personsCopy",a),o(a)},newFilter:F})),r.a.createElement("div",null,r.a.createElement("h3",null,"add a new"),r.a.createElement(g,{inputName:function(e){return d(e.target.value)},newName:s,inputNumber:function(e){return C(e.target.value)},newNumber:O,onSubmit:function(e){return P(e)}})),r.a.createElement("div",null,r.a.createElement("h3",null,"Numbers"),r.a.createElement(w,{persons:n,onClickDelete:function(e){var t=e.target.getAttribute("data-id");console.log(t);var a=n.find((function(e){return e.id===t}));if(console.log(a),window.confirm("Delete ".concat(a.name,"?"))){var r=n.filter((function(e){return e.id!==t}));return console.log("removing record with id ".concat(t)),E(t).then(M("Removed ".concat(a.name," from phonebook"),"success",5e3)).catch((function(e){console.log(e),M("Information of ".concat(s," has already been removed from server"),"error",5e3)})),o(r)}}})))};l.a.render(r.a.createElement(y,null),document.getElementById("root"))}},[[16,1,2]]]);
//# sourceMappingURL=main.4d3c0c29.chunk.js.map